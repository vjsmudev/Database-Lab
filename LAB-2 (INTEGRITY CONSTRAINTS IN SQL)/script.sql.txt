create table EMPLOYEE(
EmpNo numeric(5) primary key,
EmpName varchar(20) not null,
Gender character(1) not null check(Gender = 'M' OR Gender = 'F'),
Salary numeric(10) not null,
Address varchar(50) not null,
DNo numeric(5));

create table DEPARTMENT(
DeptNo numeric(5) primary key,
/*Candidate key is DeptName:*/
DeptName varchar(50) unique);

alter table EMPLOYEE add constraint FK_DNo foreign key(DNo) references DEPARTMENT(DeptNo);

insert into DEPARTMENT values(1, 'SWD');
insert into DEPARTMENT values(2, 'ML');
insert into DEPARTMENT values(3, 'QUANT');
insert into DEPARTMENT values(4, 'NETWORK');

insert into EMPLOYEE values(1,'Joshua','M', 45000,'LA',1);
insert into EMPLOYEE values(2,'Justin','M', 90000,'CAN',2);
insert into EMPLOYEE values(3,'Heidy','F', 100000,'CAL',1);
insert into EMPLOYEE values(4,'Anthony','M', 60000,'NYC',4);

/*Violate the constraints of primary key of employee and DEPARTMENT*/
insert into DEPARTMENT values(1, 'HARDWARE');
insert into DEPARTMENT values(2, 'CLOUD');

insert into EMPLOYEE values(1,'Justin','M', 45000,'LA',1);
insert into EMPLOYEE values(2,'Joshua','K', 45000,'CAN',2);

delete from DEPARTMENT where DeptNo in(select DNo from EMPLOYEE group by DNo having count(*) > 1 );

alter table EMPLOYEE drop constraint FK_DNo;
alter table EMPLOYEE add constraint FK_DNo foreign key (DNo) references DEPARTMENT(DeptNo) ON delete cascade;


